const media = {
  rohitSolo: [
    'photos/college_memories/rohit_solo/1288170644-IMG-20201003-WA0025.jpg',
    'photos/college_memories/rohit_solo/1467202333-IMG-20211205-WA0039.jpg',
    'photos/college_memories/rohit_solo/20230601_134624.jpg.jpeg',
    'photos/college_memories/rohit_solo/20230601_134658.jpg.jpeg',
    'photos/college_memories/rohit_solo/IMG_20190725_123628.jpg',
    'photos/college_memories/rohit_solo/IMG_20190731_113019.jpg',
    'photos/college_memories/rohit_solo/IMG_20191016_150809.jpg',
    'photos/college_memories/rohit_solo/IMG_20191205_001354.jpg',
    'photos/college_memories/rohit_solo/IMG_20200303_134127.jpg',
    'photos/college_memories/rohit_solo/IMG_20211121_111311.jpg',
    'photos/college_memories/rohit_solo/IMG_20211121_115711.jpg',
    'photos/college_memories/rohit_solo/IMG_20211130_204129.jpg',
    'photos/college_memories/rohit_solo/IMG_20211130_204134.jpg',
    'photos/college_memories/rohit_solo/IMG_20211220_214902.jpg',
    'photos/college_memories/rohit_solo/IMG_20211220_214926.jpg',
    'photos/college_memories/rohit_solo/IMG_20211231_133820.jpg',
    'photos/college_memories/rohit_solo/IMG_20211231_134115.jpg',
    'photos/college_memories/rohit_solo/IMG_20220101_141819.jpg',
    'photos/college_memories/rohit_solo/IMG_20220101_143059.jpg',
    'photos/college_memories/rohit_solo/IMG_20220329_214523.jpg',
  ],
  birthday: [
    'photos/college_memories/birthday/106878024-IMG-20211205-WA0051.jpg',
    'photos/college_memories/birthday/1381314880-IMG-20211205-WA0009.jpg',
    'photos/college_memories/birthday/1434879098-IMG-20211205-WA0025.jpg',
    'photos/college_memories/birthday/1463508249-IMG-20211205-WA0035.jpg',
    'photos/college_memories/birthday/1464431770-IMG-20211205-WA0036.jpg',
    'photos/college_memories/birthday/1465355291-IMG-20211205-WA0037.jpg',
    'photos/college_memories/birthday/1487519795-IMG-20211205-WA0040.jpg',
    'photos/college_memories/birthday/IMG-20260224-WA0004.jpg',
    'photos/college_memories/birthday/IMG-20260224-WA0007.jpg',
    'photos/college_memories/birthday/WhatsApp Image 2026-02-23 at 2.29.52 PM.jpeg',
  ],
  crazy: [
    'photos/college_memories/crazythings/1798283834-IMG-20211210-WA0009.jpg',
    'photos/college_memories/crazythings/IMG_20190806_123433.jpg',
    'photos/college_memories/crazythings/IMG_20190911_102207.jpg',
    'photos/college_memories/crazythings/IMG_20191018_145445.jpg',
    'photos/college_memories/crazythings/IMG_20191018_222325.jpg',
    'photos/college_memories/crazythings/IMG_20211123_085307.jpg',
    'photos/college_memories/crazythings/IMG_20211210_142000.jpg.jpeg',
    'photos/college_memories/crazythings/IMG_20220101_142458.jpg',
    'photos/college_memories/crazythings/IMG_20220101_142504.jpg',
    'photos/college_memories/crazythings/IMG_20220101_142510.jpg',
    'photos/college_memories/crazythings/IMG_20220102_124911.jpg',
    'photos/college_memories/crazythings/IMG_20220426_195847.jpg',
    'photos/college_memories/crazythings/IMG-20200127-WA0006.jpg',
    'photos/college_memories/crazythings/IMG-20260224-WA0005.jpg',
    'photos/college_memories/crazythings/IMG-20260224-WA0008.jpg',
    'photos/college_memories/crazythings/rohit.png',
    'photos/college_memories/crazythings/Snapchat-1008155523.jpg',
    'photos/college_memories/crazythings/Snapchat-1103301812.jpg',
    'photos/college_memories/crazythings/Snapchat-1228302645.jpg',
    'photos/college_memories/crazythings/Snapchat-349541439.jpg',
  ],
  group: [
    'photos/college_memories/group_photos/1188573863-IMG-20220429-WA0012.jpg',
    'photos/college_memories/group_photos/1778441063-IMG-20220429-WA0002.jpg',
    'photos/college_memories/group_photos/1779364584-IMG-20220429-WA0003.jpg',
    'photos/college_memories/group_photos/20230601_122234.jpg.jpeg',
    'photos/college_memories/group_photos/20230601_122250.jpg.jpeg',
    'photos/college_memories/group_photos/20230601_122513.jpg.jpeg',
    'photos/college_memories/group_photos/20230601_122853.jpg.jpeg',
    'photos/college_memories/group_photos/20230601_135133.jpg.jpeg',
    'photos/college_memories/group_photos/376023625-IMG-20230526-WA0003.jpg',
    'photos/college_memories/group_photos/IMG_20190819_182345.jpg',
    'photos/college_memories/group_photos/IMG_20190911_111021.jpg',
    'photos/college_memories/group_photos/IMG_20191018_112600.jpg',
    'photos/college_memories/group_photos/IMG_20191018_154134.jpg',
    'photos/college_memories/group_photos/IMG_20191120_160853.jpg',
    'photos/college_memories/group_photos/IMG_20191210_134032.jpg',
    'photos/college_memories/group_photos/IMG_20200130_165358.jpg',
    'photos/college_memories/group_photos/IMG_20210928_132806_346.webp',
    'photos/college_memories/group_photos/IMG_20210928_132818_379.webp',
    'photos/college_memories/group_photos/IMG_20210928_132910_214.webp',
    'photos/college_memories/group_photos/IMG_20210928_132930_489.webp',
    'photos/college_memories/group_photos/IMG_20211121_114801.jpg',
    'photos/college_memories/group_photos/IMG_20211121_115623.jpg',
    'photos/college_memories/group_photos/IMG_20211121_115642.jpg',
    'photos/college_memories/group_photos/IMG_20211220_213417.jpg',
    'photos/college_memories/group_photos/IMG_20211220_215430.jpg',
    'photos/college_memories/group_photos/IMG_20220101_143140(1).jpg',
    'photos/college_memories/group_photos/IMG_20220101_143140.jpg',
    'photos/college_memories/group_photos/IMG_20220101_143224.jpg',
    'photos/college_memories/group_photos/IMG_20220330_145228.jpg',
    'photos/college_memories/group_photos/IMG_20220331_205908.jpg.jpeg',
    'photos/college_memories/group_photos/IMG_4464.jpeg',
    'photos/college_memories/group_photos/IMG_4483.jpeg',
    'photos/college_memories/group_photos/IMG_4485.jpeg',
    'photos/college_memories/group_photos/IMG_4486.jpeg',
    'photos/college_memories/group_photos/IMG_4708.jpeg.jpg',
    'photos/college_memories/group_photos/IMG-20200201-WA0043.jpg',
    'photos/college_memories/group_photos/IMG-20200201-WA0050.jpg',
    'photos/college_memories/group_photos/WhatsApp Image 2026-02-23 at 10.47.06 PM.jpeg',
  ],
  videos: [
    'photos/college_memories/videos/1008662322-VID-20211227-WA0009.mp4',
    'photos/college_memories/videos/1038103192-VID-20201211-WA0009.mp4',
    'photos/college_memories/videos/1487855168-VID-20211226-WA0007.mp4',
    'photos/college_memories/videos/1543620912-VID-20211013-WA0001.mp4',
    'photos/college_memories/videos/1545467954-VID-20211013-WA0003.mp4',
    'photos/college_memories/videos/1707017679-VID-20211002-WA0000.mp4',
    'photos/college_memories/videos/654451687-VID-20230215-WA0000.mp4',
    'photos/college_memories/videos/706521868-VID-20211212-WA0021.mp4',
    'photos/college_memories/videos/dedicated to rohit.mp4',
    'photos/college_memories/videos/frnds.mp4',
    'photos/college_memories/videos/Online Classes be like.mp4',
    'photos/college_memories/videos/pubg_lover.mp4',
    'photos/college_memories/videos/Snapchat-1014084466.mp4',
    'photos/college_memories/videos/Snapchat-1091387262.mp4',
    'photos/college_memories/videos/Snapchat-151202468.mp4',
    'photos/college_memories/videos/Snapchat-1578048681.mp4',
    'photos/college_memories/videos/Snapchat-1856119902.mp4',
    'photos/college_memories/videos/Snapchat-1992098415.mp4',
    'photos/college_memories/videos/Snapchat-2110505258.mp4',
    'photos/college_memories/videos/Snapchat-2119467050.mp4',
    'photos/college_memories/videos/Snapchat-427250309.mp4',
    'photos/college_memories/videos/Snapchat-520741345.mp4',
    'photos/college_memories/videos/Snapchat-76387195.mp4',
    'photos/college_memories/videos/Snapchat-858097018.mp4',
    'photos/college_memories/videos/VID-20260224-WA0009.mp4',
    'photos/college_memories/videos/VID-20260224-WA0011.mp4',
    'photos/college_memories/videos/WhatsApp Video 2026-02-23 at 10.48.33 PM.mp4',
  ],
};

const captionPrefixes = {
  rohitSolo: 'Rohit Solo Memory',
  birthday: 'Birthday Memory',
  crazy: 'Crazy Moment',
  group: 'Group Memory',
  videos: 'College Video',
};

// Add/modify custom captions per exact file path here.
const captionOverrides = {
  'photos/college_memories/videos/dedicated to rohit.mp4': 'Dedicated to Rohit',
  'photos/college_memories/videos/frnds.mp4': 'Friends Montage',
  'photos/college_memories/videos/Online Classes be like.mp4': 'Online Classes Be Like',
  'photos/college_memories/videos/pubg_lover.mp4': 'PUBG Lover Clip',
};

function buildItems(groupKey, paths) {
  const prefix = captionPrefixes[groupKey] || 'Memory';
  return paths.map((path, index) => {
    const serial = String(index + 1).padStart(2, '0');
    return {
      path,
      caption: captionOverrides[path] || `${prefix} ${serial}`,
    };
  });
}

const mediaItems = {
  rohitSolo: buildItems('rohitSolo', media.rohitSolo),
  birthday: buildItems('birthday', media.birthday),
  crazy: buildItems('crazy', media.crazy),
  group: buildItems('group', media.group),
  videos: buildItems('videos', media.videos),
};

function createImageCard(item) {
  const card = document.createElement('button');
  card.type = 'button';
  card.className = 'card';
  card.dataset.type = 'image';
  card.dataset.path = item.path;
  card.dataset.caption = item.caption;

  const img = document.createElement('img');
  img.src = encodeURI(item.path);
  img.alt = card.dataset.caption;
  img.loading = 'lazy';
  img.decoding = 'async';

  const cap = document.createElement('span');
  cap.className = 'card-cap';
  cap.textContent = card.dataset.caption;

  card.append(img, cap);
  return card;
}

function createVideoCard(item) {
  const card = document.createElement('button');
  card.type = 'button';
  card.className = 'card video-card';
  card.dataset.type = 'video';
  card.dataset.path = item.path;
  card.dataset.caption = item.caption;

  const vid = document.createElement('video');
  vid.src = encodeURI(item.path);
  vid.preload = 'none';
  vid.muted = true;
  vid.playsInline = true;

  const badge = document.createElement('span');
  badge.className = 'video-pill';
  badge.textContent = 'Video';

  const cap = document.createElement('span');
  cap.className = 'card-cap';
  cap.textContent = card.dataset.caption;

  card.append(vid, badge, cap);
  return card;
}

function renderGrid(containerId, items, kind) {
  const host = document.getElementById(containerId);
  if (!host) return;
  const frag = document.createDocumentFragment();
  items.forEach((item) => {
    frag.append(kind === 'video' ? createVideoCard(item) : createImageCard(item));
  });
  host.appendChild(frag);
}

const lightbox = document.getElementById('lightbox');
const lbWrap = document.getElementById('lb-media-wrap');
const lbCaption = document.getElementById('lb-caption');

function closeLightbox() {
  lightbox.classList.remove('open');
  lightbox.setAttribute('aria-hidden', 'true');
  document.body.style.overflow = '';
  lbWrap.innerHTML = '';
}

function openLightbox(type, path, caption) {
  lbWrap.innerHTML = '';

  if (type === 'video') {
    const video = document.createElement('video');
    video.src = encodeURI(path);
    video.controls = true;
    video.autoplay = true;
    video.playsInline = true;
    lbWrap.appendChild(video);
  } else {
    const img = document.createElement('img');
    img.src = encodeURI(path);
    img.alt = caption;
    lbWrap.appendChild(img);
  }

  lbCaption.textContent = caption;
  lightbox.classList.add('open');
  lightbox.setAttribute('aria-hidden', 'false');
  document.body.style.overflow = 'hidden';
}

function initCardEvents() {
  document.querySelectorAll('.card').forEach((card) => {
    card.addEventListener('click', () => {
      openLightbox(card.dataset.type, card.dataset.path, card.dataset.caption || '');
    });
  });
}

function initLightboxEvents() {
  document.getElementById('lb-close').addEventListener('click', closeLightbox);
  lightbox.addEventListener('click', (e) => {
    if (e.target === lightbox) closeLightbox();
  });
  document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeLightbox();
  });
}

function initNavHighlight() {
  const links = document.querySelectorAll('.top-nav a[data-target]');
  const sections = document.querySelectorAll('[data-nav-id]');

  links.forEach((link) => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const id = link.dataset.target;
      const section = document.getElementById(id);
      if (section) section.scrollIntoView({ behavior: 'smooth', block: 'start' });
    });
  });

  const io = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (!entry.isIntersecting) return;
      const id = entry.target.getAttribute('data-nav-id');
      links.forEach((link) => link.classList.toggle('active', link.dataset.target === id));
    });
  }, { threshold: 0.35 });

  sections.forEach((s) => io.observe(s));
}

function setStats() {
  const totalPhotos = mediaItems.rohitSolo.length + mediaItems.birthday.length + mediaItems.crazy.length + mediaItems.group.length;
  document.getElementById('stat-photos').textContent = String(totalPhotos);
  document.getElementById('stat-videos').textContent = String(mediaItems.videos.length);
}

function init() {
  renderGrid('grid-solo', mediaItems.rohitSolo, 'image');
  renderGrid('grid-birthday', mediaItems.birthday, 'image');
  renderGrid('grid-crazy', mediaItems.crazy, 'image');
  renderGrid('grid-group', mediaItems.group, 'image');
  renderGrid('grid-videos', mediaItems.videos, 'video');

  setStats();
  initCardEvents();
  initLightboxEvents();
  initNavHighlight();
}

init();
